{#
  @file
  Clean SAHO Header - Simple & Banging on All Devices
  
  @see saho_preprocess_header()
#}
<header class="saho-header" role="banner">
  {# Accent bar #}
  <div class="saho-accent-bar"></div>
  
  <div class="container-fluid">
    <div class="saho-header-content d-flex align-items-center justify-content-between py-3">
      
      {# Logo Section #}
      <div class="saho-logo">
        <a href="{{ path('<front>') }}" class="d-flex align-items-center text-decoration-none" aria-label="SAHO Homepage">
          <img src="/themes/custom/saho/logo.svg" alt="SAHO" class="saho-logo-img">
          <div class="saho-logo-text d-none d-sm-block ms-3">
            <div class="saho-logo-title">South African History Online</div>
            <div class="saho-logo-tagline">Towards a People's History</div>
          </div>
        </a>
      </div>

      {# Desktop Navigation #}
      <nav class="saho-desktop-nav d-none d-lg-block" role="navigation">
        {{ drupal_menu('main') }}
      </nav>

      {# Right Actions #}
      <div class="saho-actions d-flex align-items-center gap-3">
        
        {# Desktop Search #}
        <form action="/search" method="get" class="saho-search d-none d-md-flex" role="search">
          <input type="search" name="search_api_fulltext" placeholder="Search history..." class="saho-search-input" aria-label="Search">
          <button type="submit" class="saho-search-btn" aria-label="Search">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
              <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
            </svg>
          </button>
        </form>

        {# Tools Dropdown #}
        <div class="dropdown me-2">
          <button class="btn btn-outline-secondary dropdown-toggle d-flex align-items-center" type="button" id="toolsDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-tools me-2" viewBox="0 0 16 16">
              <path d="M1 0 0 1l2.2 3.081a1 1 0 0 0 .815.419h.07a1 1 0 0 1 .708.293l2.675 2.675-2.617 2.654A3.003 3.003 0 0 0 0 13a3 3 0 1 0 5.878-.851l2.654-2.617.968.968-.305.914a1 1 0 0 0 .242 1.023l3.27 3.27a.997.997 0 0 0 1.414 0l1.586-1.586a.997.997 0 0 0 0-1.414l-3.27-3.27a1 1 0 0 0-1.023-.242L10.5 9.5l-.96-.96 2.68-2.643A3.005 3.005 0 0 0 16 3c0-.269-.035-.53-.102-.777l-2.14 2.141L12 4l-.364-1.757L13.777.102a3 3 0 0 0-3.675 3.68L7.462 6.46 4.793 3.793a1 1 0 0 1-.293-.707v-.071a1 1 0 0 0-.419-.814L1 0Zm9.646 10.646a.5.5 0 0 1 .708 0l2.914 2.915a.5.5 0 0 1-.707.707l-2.915-2.914a.5.5 0 0 1 0-.708ZM3 11l.471.242.529.026.287.445.445.287.026.529L5 13l-.242.471-.026.529-.445.287-.287.445-.529.026L3 15l-.471-.242L2 14.732l-.287-.445L1.268 14l-.026-.529L1 13l.242-.471.026-.529.445-.287.287-.445.529-.026L3 11Z"/>
            </svg>
            <span class="d-none d-sm-inline">Tools</span>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="toolsDropdown">
            <li>
              <button type="button" class="dropdown-item d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#citeModal">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-quote me-2" viewBox="0 0 16 16">
                  <path d="M12 12a1 1 0 0 0 1-1V8.558a1 1 0 0 0-1-1h-1.388c0-.351.021-.703.062-1.054.062-.372.166-.703.31-.992.145-.29.331-.517.559-.683.227-.186.516-.279.868-.279V3c-.579 0-1.085.124-1.52.372a3.322 3.322 0 0 0-1.085.992 4.92 4.92 0 0 0-.62 1.458A7.712 7.712 0 0 0 9 7.558V11a1 1 0 0 0 1 1h2Zm-6 0a1 1 0 0 0 1-1V8.558a1 1 0 0 0-1-1H4.612c0-.351.021-.703.062-1.054.062-.372.166-.703.31-.992.145-.29.331-.517.559-.683.227-.186.516-.279.868-.279V3c-.579 0-1.085.124-1.52.372a3.322 3.322 0 0 0-1.085.992 4.92 4.92 0 0 0-.62 1.458A7.712 7.712 0 0 0 3 7.558V11a1 1 0 0 0 1 1h2Z"/>
                </svg>
                Cite This Page
              </button>
            </li>
            <li>
              <button type="button" class="dropdown-item d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#shareModal">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-share me-2" viewBox="0 0 16 16">
                  <path d="M13.5 1a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM11 2.5a2.5 2.5 0 1 1 .603 1.628l-6.718 3.12a2.499 2.499 0 0 1 0 1.504l6.718 3.12a2.5 2.5 0 1 1-.488.876l-6.718-3.12a2.5 2.5 0 1 1 0-3.256l6.718-3.12A2.5 2.5 0 0 1 11 2.5zm-8.5 4a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zm11 5.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3z"/>
                </svg>
                Share
              </button>
            </li>
            <li>
              <a class="dropdown-item d-flex align-items-center" href="javascript:window.print()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-printer me-2" viewBox="0 0 16 16">
                  <path d="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z"/>
                  <path d="M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"/>
                </svg>
                Print
              </a>
            </li>
            <li>
              <a class="dropdown-item d-flex align-items-center" href="/advanced-search">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search me-2" viewBox="0 0 16 16">
                  <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                </svg>
                Advanced Search
              </a>
            </li>
            <li>
              <a class="dropdown-item d-flex align-items-center" href="/saho-timeline">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clock-history me-2" viewBox="0 0 16 16">
                  <path d="M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022l-.074.997zm2.004.45a7.003 7.003 0 0 0-.985-.299l.219-.976c.383.086.76.2 1.126.342l-.36.933zm1.37.71a7.01 7.01 0 0 0-.439-.27l.493-.87a8.025 8.025 0 0 1 .979.654l-.615.789a6.996 6.996 0 0 0-.418-.302zm1.834 1.79a6.99 6.99 0 0 0-.653-.796l.724-.69c.27.285.52.59.747.91l-.818.576zm.744 1.352a7.08 7.08 0 0 0-.214-.468l.893-.45a7.976 7.976 0 0 1 .45 1.088l-.95.313a7.023 7.023 0 0 0-.179-.483zm.53 2.507a6.991 6.991 0 0 0-.1-1.025l.985-.17c.067.386.106.778.116 1.17l-1 .025zm-.131 1.538c.033-.17.06-.339.081-.51l.993.123a7.957 7.957 0 0 1-.23 1.155l-.964-.267c.046-.165.086-.332.12-.501zm-.952 2.379c.184-.29.346-.594.486-.908l.914.405c-.16.36-.345.706-.555 1.038l-.845-.535zm-.964 1.205c.122-.122.239-.248.35-.378l.758.653a8.073 8.073 0 0 1-.401.432l-.707-.707z"/>
                  <path d="M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0v1z"/>
                  <path d="M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5z"/>
                </svg>
                Timeline Explorer
              </a>
            </li>
          </ul>
        </div>
        
        {# Contribute Button #}
        <a href="/form/contribute" class="saho-contribute-btn">
          <span class="saho-contribute-icon">✦</span>
          <span class="saho-contribute-text">Contribute</span>
        </a>

        {# Mobile Menu Toggle #}
        <button class="saho-mobile-toggle d-lg-none" 
                type="button" 
                data-bs-toggle="offcanvas" 
                data-bs-target="#sahoMobileMenu" 
                aria-label="Open menu">
          <span class="saho-hamburger">
            <span></span>
            <span></span>
            <span></span>
          </span>
        </button>
      </div>
    </div>
  </div>
</header>

{# Mobile Menu Offcanvas #}
<div class="offcanvas offcanvas-start saho-mobile-menu" 
     tabindex="-1" 
     id="sahoMobileMenu" 
     aria-labelledby="sahoMobileMenuLabel">
  
  <div class="offcanvas-header">
    <div class="d-flex align-items-center">
      <img src="/themes/custom/saho/logo.svg" alt="SAHO" class="saho-mobile-logo me-2">
      <h5 id="sahoMobileMenuLabel" class="mb-0">Menu</h5>
    </div>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  
  <div class="offcanvas-body">
    {# Mobile Search #}
    <form action="/search" method="get" class="saho-mobile-search mb-4" role="search">
      <div class="input-group">
        <input type="search" name="search_api_fulltext" placeholder="Search history..." class="form-control" aria-label="Search">
        <button type="submit" class="btn btn-outline-secondary text-gold">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
          </svg>
        </button>
      </div>
    </form>

    {# Mobile Navigation Menu #}
    <nav class="saho-mobile-nav" role="navigation">
      {% if main_menu %}
        <ul class="nav flex-column">
          {% for item in main_menu %}
            <li class="nav-item{% if item.below %} dropdown{% endif %}">
              {% if item.below %}
                <a href="#" class="nav-link dropdown-toggle d-flex justify-content-between align-items-center{% if item.in_active_trail %} active{% endif %}" 
                   data-bs-toggle="collapse" 
                   data-bs-target="#mobileSubmenu{{ loop.index }}" 
                   aria-expanded="false" 
                   aria-controls="mobileSubmenu{{ loop.index }}">
                  {{ item.title }}
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                  </svg>
                </a>
                <div class="collapse" id="mobileSubmenu{{ loop.index }}">
                  <ul class="nav flex-column ms-3 border-start border-2 ps-2 my-2">
                    {% for subitem in item.below %}
                      <li class="nav-item{% if subitem.below %} dropdown{% endif %}">
                        {% if subitem.below %}
                          <a href="#" class="nav-link dropdown-toggle d-flex justify-content-between align-items-center{% if subitem.in_active_trail %} active{% endif %}" 
                             data-bs-toggle="collapse" 
                             data-bs-target="#mobileSubSubmenu{{ loop.parent.loop.index }}_{{ loop.index }}" 
                             aria-expanded="false" 
                             aria-controls="mobileSubSubmenu{{ loop.parent.loop.index }}_{{ loop.index }}">
                            {{ subitem.title }}
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
                              <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                            </svg>
                          </a>
                          <div class="collapse" id="mobileSubSubmenu{{ loop.parent.loop.index }}_{{ loop.index }}">
                            <ul class="nav flex-column ms-3 border-start border-2 ps-2 my-2">
                              {% for subsubitem in subitem.below %}
                                <li class="nav-item">
                                  <a href="{{ subsubitem.url }}" class="nav-link{% if subsubitem.in_active_trail %} active{% endif %}">
                                    {{ subsubitem.title }}
                                  </a>
                                </li>
                              {% endfor %}
                            </ul>
                          </div>
                        {% else %}
                          <a href="{{ subitem.url }}" class="nav-link{% if subitem.in_active_trail %} active{% endif %}">
                            {{ subitem.title }}
                          </a>
                        {% endif %}
                      </li>
                    {% endfor %}
                  </ul>
                </div>
              {% else %}
                <a href="{{ item.url }}" class="nav-link{% if item.in_active_trail %} active{% endif %}">
                  {{ item.title }}
                </a>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      {% else %}
        {{ drupal_menu('main') }}
      {% endif %}
    </nav>

    {# Mobile Contribute #}
    <div class="mt-4 pt-4 border-top">
      <a href="/form/contribute" class="btn btn-primary w-100">
        <span class="me-2">✦</span> Contribute to SAHO
      </a>
    </div>
  </div>
</div>

{# Cite Modal #}
<div class="modal fade" id="citeModal" tabindex="-1" aria-labelledby="citeModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="citeModalLabel">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-quote me-2" viewBox="0 0 16 16">
            <path d="M12 12a1 1 0 0 0 1-1V8.558a1 1 0 0 0-1-1h-1.388c0-.351.021-.703.062-1.054.062-.372.166-.703.31-.992.145-.29.331-.517.559-.683.227-.186.516-.279.868-.279V3c-.579 0-1.085.124-1.52.372a3.322 3.322 0 0 0-1.085.992 4.92 4.92 0 0 0-.62 1.458A7.712 7.712 0 0 0 9 7.558V11a1 1 0 0 0 1 1h2Zm-6 0a1 1 0 0 0 1-1V8.558a1 1 0 0 0-1-1H4.612c0-.351.021-.703.062-1.054.062-.372.166-.703.31-.992.145-.29.331-.517.559-.683.227-.186.516-.279.868-.279V3c-.579 0-1.085.124-1.52.372a3.322 3.322 0 0 0-1.085.992 4.92 4.92 0 0 0-.62 1.458A7.712 7.712 0 0 0 3 7.558V11a1 1 0 0 0 1 1h2Z"/>
          </svg>
          Cite This Page
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label class="form-label fw-bold">MLA Format:</label>
          <div class="p-3 bg-light rounded">
            <span id="citeMLA">Loading citation...</span>
            <button type="button" class="btn btn-sm btn-outline-primary ms-2" onclick="copyCitation('citeMLA')">Copy</button>
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label fw-bold">APA Format:</label>
          <div class="p-3 bg-light rounded">
            <span id="citeAPA">Loading citation...</span>
            <button type="button" class="btn btn-sm btn-outline-primary ms-2" onclick="copyCitation('citeAPA')">Copy</button>
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label fw-bold">Chicago Format:</label>
          <div class="p-3 bg-light rounded">
            <span id="citeChicago">Loading citation...</span>
            <button type="button" class="btn btn-sm btn-outline-primary ms-2" onclick="copyCitation('citeChicago')">Copy</button>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

{# Share Modal #}
<div class="modal fade" id="shareModal" tabindex="-1" aria-labelledby="shareModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="shareModalLabel">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-share me-2" viewBox="0 0 16 16">
            <path d="M13.5 1a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM11 2.5a2.5 2.5 0 1 1 .603 1.628l-6.718 3.12a2.499 2.499 0 0 1 0 1.504l6.718 3.12a2.5 2.5 0 1 1-.488.876l-6.718-3.12a2.5 2.5 0 1 1 0-3.256l6.718-3.12A2.5 2.5 0 0 1 11 2.5zm-8.5 4a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zm11 5.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3z"/>
          </svg>
          Share This Page
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label for="shareUrl" class="form-label">Page URL:</label>
          <div class="input-group">
            <input type="text" class="form-control" id="shareUrl" readonly>
            <button class="btn btn-outline-primary" type="button" onclick="copyShareUrl()">Copy</button>
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label">Share on social media:</label>
          <div class="d-flex gap-2 flex-wrap">
            <a href="#" id="shareFacebook" target="_blank" class="btn btn-primary btn-sm">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-facebook me-1" viewBox="0 0 16 16">
                <path d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951z"/>
              </svg>
              Facebook
            </a>
            <a href="#" id="shareTwitter" target="_blank" class="btn btn-dark btn-sm">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-twitter-x me-1" viewBox="0 0 16 16">
                <path d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75Zm-.86 13.028h1.36L4.323 2.145H2.865l8.875 11.633Z"/>
              </svg>
              X (Twitter)
            </a>
            <a href="#" id="shareLinkedIn" target="_blank" class="btn btn-info btn-sm">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-linkedin me-1" viewBox="0 0 16 16">
                <path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"/>
              </svg>
              LinkedIn
            </a>
            <a href="#" id="shareEmail" class="btn btn-secondary btn-sm">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-envelope me-1" viewBox="0 0 16 16">
                <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4Zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2Zm13 2.383-4.708 2.825L15 11.105V5.383Zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741ZM1 11.105l4.708-2.897L1 5.383v5.722Z"/>
              </svg>
              Email
            </a>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>