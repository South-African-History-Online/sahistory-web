{#
/**
 * @file
 * Template for the upcoming event image field in the all-upcoming-events view.
 *
 * This ensures proper image style is applied to prevent pixelation.
 *
 * Available variables:
 * - output: The raw field output from the entity.
 * - row: The raw result object.
 * - view: The view object.
 * - field: The field handler object that can process the output.
 */
#}

{%- if row._entity.field_upcomingevent_image.entity and row._entity.field_upcomingevent_image.entity.uri.value -%}
  {% set image_entity = row._entity.field_upcomingevent_image.entity %}
  {% set image_uri = image_entity.uri.value %}
  {% set alt_text = row._entity.field_upcomingevent_image.alt %}
  {% set title = row._entity.title.value %}
  
  {# Only apply image style if we have a valid image URI #}
  {% if image_uri %}
    {% set styled_image_url = image_uri|image_style('upcoming_events_front') %}
    
    <a href="{{ path('entity.node.canonical', {'node': row._entity.nid.value}) }}" aria-label="View {{ title }}">
      <img
        src="{{ styled_image_url }}"
        alt="{{ alt_text|default(title) }}"
        loading="lazy"
        decoding="async"
      >
    </a>
  {% endif %}
{%- endif -%}